<!DOCTYPE html>
<meta charset="utf-8">

<!-- Add a radio button -->
<input type="number" id="buttonXlim" value=9>

<!-- Load d3.js -->
<script src='https://d3js.org/d3.v5.min.js'></script>
  
<!-- Create a div where the graph will take place -->
<body onload='init()'>
<div id="mpgchart"></div>
  
<script>
  
async function init() {
// set the dimensions and margins of the graph
var margin = {top: 10, right: 30, bottom: 30, left: 60},
    width = 460 - margin.left - margin.right,
    height = 400 - margin.top - margin.bottom;

// append the svg object to the body of the page
var svg = d3.select("#mpgchart")
  .append("svg")
    .attr("width", width + margin.left + margin.right)
    .attr("height", height + margin.top + margin.bottom)
  .append("g")
    .attr("transform",
          "translate(" + margin.left + "," + margin.top + ")");


d3.csv("https://flunky.github.io/cars2017.csv").then(data => {
    // Parse the data
    data.forEach(d => {
        d.EngineCylinders = +d.EngineCylinders;
        d.AverageHighwayMPG = +d.AverageHighwayMPG;
        d.AverageCityMPG = +d.AverageCityMPG;
        });
    
    var x = d3.scaleLog().domain([10,150]).range([0, width-margin*2])
    var y = d3.scaleLog().domain([10,150]).range([height-margin*2, 0])

    var xAxis = d3.axisBottom(x).tickValues([10,20,50,100]).tickFormat(d3.format("~s"))
    var yAxis = d3.axisLeft(y).tickValues([10,20,50,100]).tickFormat(d3.format("~s"))


    d3.select("svg")
        .selectAll("g")
        .data(data)
        .enter()
        .append("circle")
        .attr("cx", d => x(d.AverageCityMPG))
        .attr("cy", d => y(d.AverageHighwayMPG))
        .attr("r", function(d) { return d.EngineCylinders+2;})
    d3.select("svg")
        .append("g")
        .attr("transform", "translate("+ margin +"," + margin +")")
        .call(yAxis)
    d3.select("svg")
        .append("g")
        .attr("transform", "translate("+ margin +"," + (height-margin) +")")
        .call(xAxis)
})
}
</script>
</body>
